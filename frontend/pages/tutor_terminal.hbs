<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        /* Style for Navbar */
        .navbar {
            background-color: #333;
            overflow: hidden;
        }

        .navbar a {
            float: left;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            font-size: 17px;
        }

        .navbar a:hover {
            background-color: #ddd;
            color: black;
        }

        .navbar a.active {
            background-color: #04AA6D;
            color: white;
        }

        /* Style for Announcement Cards */
        .announcement-card {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            width: 100%;
            margin: 10px;
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
            background-color: #fff;
            padding: 20px;
        }

.appointment-box {
  background-color: #f2f2f2;
  border: 1px solid #ddd;
  padding: 10px;
  margin: 10px;
  width: 30%;
  box-sizing: border-box;
  display: inline-block;
}



        .announcement-card h1 {
            font-size: 28px;
            color: #333;
            margin-bottom: 10px;
        }

        .announcement-card p {
            font-size: 16px;
            color: #999;
            margin-bottom: 0;
        }

        /* Style for Tutors Cards */
        .tutors-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .tutors-card {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            width: 300px;
            margin: 10px;
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
        }

        .tutors-card img {
            width: 100%;
            height: auto;
        }

        .tutors-card h4 {
            color: #4CAF50;
        }

        .tutors-card p {
            text-align: justify;
            margin: 10px;
            color: gray;
        }

        .card {
            width: calc(33.33% - 40px);
            margin: 20px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            transition: 0.3s;
        }

        .card:hover {
            box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
        }

        .card img {
            width: 100%;
            height: auto;
        }

        .card p {
            margin: 10px;
            font-size: 18px;
            text-align: center;
        }

        .tutors-header {
            margin-bottom: 20px;
            text-align: center;
            font-size: 28px;
            font-weight: bold;
        }

        .tutors-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .tutors-card {
            width: calc(33.33% - 40px);
            margin: 20px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            transition: 0.3s;
        }

        .tutors-card:hover {
            box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
        }

        .tutors-card img {
            width: 100%;
            height: auto;
        }

        .tutors-card p {
            margin: 10px;
            font-size: 18px;
            text-align: center;
        }
    </style>
</head>
home postad viewMyAds appointments requests reviews settings
<body>
    <div class="navbar">
        <a class="active" href="#" id="home-link">Home</a>
        <a href="#" id="ads-link">Post an Ad</a>
        <a href="#" id="reviews-link">View My Ads</a>
        <a href="#" id="reviews-link">My Appointments</a>
        <a href="#" id="resources-link">Requests</a>
        <a href="#" id="announcements-link">View Announcements</a>
        <a href="#" id="announcements-link">View my reviews</a>
        {{!-- <a href="#" id="settings-link">Settings</a> --}}
        <a href="/frontend/pages/settings.hbs">Settings</a>
    </div>

    <!-- Content -->
    <div class="search-container" style="text-align: center;margin: top 5px;">
        <input type="text" id="search-input" placeholder="Search...">
        <button id="search-button">Search</button>
    </div>

    <div id="ad-form-container"></div>
    <div id="requests-container"></div>
    <div class="container">
        <h1 class="tutors-header"></h1>
        <div class="tutors-container" id="tutors-data">
            <!-- tutors data will be displayed here -->
        </div>

        <div class="container">
            <h1 style="text-align: center;"></h1>
            <div class="tutors-row" id="tutors-data"></div>
        </div>

        <div class="container">
            <h1 style="text-align: center;"></h1>
            <div class="tutors-row" id="announcement-data"></div>
        </div>

        <div class="appointments-container"></div>  
        <div class="deletereviews"> </div>
      

</body>

<script>
    const navbarLinks = document.querySelectorAll(".navbar a");

    window.onload = function () {
        displayHomePage();
    }

    navbarLinks.forEach(link => {
        link.addEventListener("click", event => {
            event.preventDefault();

            const page = event.target.textContent;

            if (page === "Home") {
                displayHomePage();
            } 
            if (page === "View Announcements") {
                displayAnnouncementsPage();
            }
            if (page ==="Post an Ad") {
                showAdForm();
            }
            if (page==="View My Ads") {
                displayAds();
            }
            if (page==="Requests") {
                displayRequestsPage();
            }
            if (page==="My Appointments")
            {
                displayAppointmentsPage();
            }
            if (page==="View my reviews"){
                displayDeleteReview();
            }

            // Push state to browser history
            window.history.pushState({}, page, `/${page.toLowerCase()}`);
        });
    });

    window.addEventListener('popstate', () => {
        if (window.history.state) {
            displayHomePage();
        }
        else {
            displayHomePage();
        }
    });

   async function displayHomePage() {
      const appointmentsContainer = document.querySelector(".appointments-container");
       appointmentsContainer.innerHTML = "";
     document.querySelector('.deletereviews').innerHTML = "";
     document.getElementById("requests-container").innerHTML = "";
        // To hide the div with class "search-container"
        document.getElementById("ad-form-container").innerHTML = "";
        document.querySelector('.search-container').style.display = 'none';

        document.getElementById("announcement-data").innerHTML = "";

        try {
            const email = window.localStorage.getItem("username");
            const response = await fetch(`/username/${email}`);
            const data = await response.json();
            const { name } = data;
            document.getElementById("tutors-data").innerHTML = `
      <div class="container">
        <h1 style="text-align: center;">Welcome ${name}</h1>
        <p>ha bhai yeh bchal raha hy home</p>
        <div class="tutors-row" id="tutors-data"></div>
      </div>
    `;
        } catch (error) {
            console.error(error);
            // Display error message
            document.getElementById("tutors-data").innerHTML = `
      <div class="container">
        <h1 style="text-align: center;">Error</h1>
        <p>Failed to retrieve username.</p>
        <div class="tutors-row" id="tutors-data"></div>
      </div>
    `;
        }
    }




    ///////////////////
  const displayAds = async () => {
      const appointmentsContainer = document.querySelector(".appointments-container");
      appointmentsContainer.innerHTML = "";
     document.querySelector('.deletereviews').innerHTML = "";
     document.getElementById("requests-container").innerHTML = "";
      document.getElementById("tutors-data").innerHTML = "";
      document.getElementById("announcement-data").innerHTML = "";
      document.querySelector('.search-container').style.display = 'none';
      // Clear the ad form container
      document.getElementById("ad-form-container").innerHTML = "";
         document.getElementById("announcement-data").innerHTML = "";
        const email = window.localStorage.getItem("username");
        try {
            const response = await fetch(`/username/${email}`);
            const data = await response.json();
            const username = data.name;
            const adsResponse = await fetch(`/adss/${username}`);
            const adsData = await adsResponse.json();
            const ads = adsData.ads;
            let adsHTML = '';
            if (ads.length > 0) {
                adsHTML = ads.map(ad => `
        <div class="card">
          <img src="${ad.image}" alt="${ad.subject}">
          <p>${ad.time}</p>
          <p><b>Grade:</b> ${ad.class}</p>
          <p><b>Subject:</b> ${ad.subject}</p>
          <p><b>Price:</b> ${ad.price}</p>
           <form onsubmit="try { removeAd('${ad._id}'); } catch(err) { console.error(err); } return false;">
                    <button type="submit" style="padding: 5px;margin-bottom:5px">Remove Ad</button>
                </form>
        </div>
      `).join('');
            } else {
                adsHTML = '<p>No ads found for this username</p>';
            }
            document.getElementById("tutors-data").innerHTML = `
      <div class="container">
        <h1 style="text-align: center;">${username}, Your all Ads are below</h1>
        <div class="tutors-row" id="ads-data">${adsHTML}</div>
      </div>
    `;
        } catch (error) {
            console.error(error);
            alert('Error fetching ads data');
        }
    };

    function removeAd(adId) {
        fetch('/deleteads', {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ _id: adId })
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                displayAds();
                console.log('Ad deleted successfully');
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });
    }
    // Call the displayAds function to initially display all ads


    // Add event listener to search button
    document.getElementById("search-button").addEventListener("click", () => {
        // To show the div with class "search-container"


        const searchQuery = document.getElementById("search-input").value.toLowerCase();
        fetch(`/search?q=${searchQuery}`)
            .then(response => response.json())
            .then(data => {
                let html = "";
                data.forEach((ad, index) => {
                    html += `
            <div class="tutors-card">
              <img src="${ad.image}" alt="${ad.subject} - ${ad.class}">
              <h4 style="text-align: center;">${ad.time}</h4>
              <p>${ad.subject} - ${ad.class}</p>
              <p>${ad.price}</p>
            </div>
          `;
                    if (index % 3 === 2 || index === data.length - 1) {
                        html += '</div>';
                    }
                });
                document.getElementById("tutors-data").innerHTML = html;
                // Add the current search query to the browser history
                history.pushState({ searchQuery }, null, `/search?q=${searchQuery}`);
            })
            .catch(err => console.error(err));
    });

    // Add event listener to popstate event (back/forward buttons)

 function showAdForm() {
     document.querySelector('.deletereviews').innerHTML = "";
            document.getElementById("requests-container").innerHTML = "";
     document.getElementById("tutors-data").innerHTML = "";
     document.getElementById("announcement-data").innerHTML = "";
     document.querySelector(".search-container").style.display = "none";
     document.getElementById("ad-form-container").innerHTML = "";
     const appointmentsContainer = document.querySelector(".appointments-container");
     appointmentsContainer.innerHTML = "";

        // Create the form elements
        const form = document.createElement("form");
        form.id = "ad-form";
        form.style.marginTop = "20px";
        form.style.textAlign = "center";

        const nameDiv = document.createElement("div");
        const nameLabel = document.createElement("label");
        nameLabel.textContent = "Enter Your User Name: ";
        const nameInput = document.createElement("input");
        nameInput.type = "text";
        nameInput.name = "name";
        nameDiv.appendChild(nameLabel);
        nameDiv.appendChild(nameInput);

        const subjectsDiv = document.createElement("div");
        const subjectsLabel = document.createElement("label");
        subjectsLabel.textContent = "Enter Subjects: ";
        const subjectsInput = document.createElement("input");
        subjectsInput.type = "text";
        subjectsInput.name = "subject";
        subjectsDiv.appendChild(subjectsLabel);
        subjectsDiv.appendChild(subjectsInput);
        const gradeDiv = document.createElement("div");
     const gradeLabel = document.createElement("label");
     gradeLabel.textContent = "Select Grade: ";
     const gradeSelect = document.createElement("select");
     const options = ["grade 6-8", "grade 6", "grade 7", "grade 8", "olevels", "alevels", "fsc", "matric", "olevels 1", "olevels 2", "fsc 1", "fsc 2", "matric 1", "matric 2", "bachelors", "masters", "gre", "sat","all grades","others"];

     options.forEach(function (option) {
         const gradeOption = document.createElement("option");
         gradeOption.value = option;
         gradeOption.textContent = option;
         gradeSelect.appendChild(gradeOption);
     });

     gradeSelect.name = "classs";
     gradeDiv.appendChild(gradeLabel);
     gradeDiv.appendChild(gradeSelect);


      const costDiv = document.createElement("div");
const costLabel = document.createElement("label");
costLabel.textContent = "Select Cost: ";
const costSelect = document.createElement("select");
costSelect.name = "pricee";
const optionss = [
  "5000 pkr per month",
  "10000 pkr per month",
  "15000 pkr per month",
  "20000 pkr per month",
  "25000 pkr per month",
  "30000 pkr per month",
  "35000 pkr per month",
  "40000 pkr per month",
  "50000 pkr per month",
  "Above 50000 pkr",
];
optionss.forEach((option) => {
  const optionElem = document.createElement("option");
  optionElem.textContent = option;
  costSelect.appendChild(optionElem);
});
costDiv.appendChild(costLabel);
costDiv.appendChild(costSelect);


        const imageDiv = document.createElement("div");
        const imageLabel = document.createElement("label");
        imageLabel.textContent = "Enter Image Link: ";
        const imageInput = document.createElement("input");
        imageInput.type = "text";
        imageInput.name = "image";
        imageDiv.appendChild(imageLabel);
        imageDiv.appendChild(imageInput);

        const submitButton = document.createElement("button");
        submitButton.type = "submit";
        submitButton.textContent = "Submit";

        // Add a submit event listener to the form
        form.addEventListener("submit", async (event) => {
            event.preventDefault(); // Prevent the default form submission behavior

            // Check if the entered username exists
            const username = nameInput.value;
            const tutorResponse = await fetch(`/tutor/${username}`);
            if (tutorResponse.status === 404) {
                alert("Username not found. Ad cannot be posted.");
                return;
            }
    const gradeSelect = document.querySelector("select[name='classs']");
    const pricc = document.querySelector("select[name='pricee']")
            // Send a POST request to the server to post the ad
            const adResponse = await fetch("/postad", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    subject: subjectsInput.value,
                    class: gradeSelect.options[gradeSelect.selectedIndex].value,
                    time: nameInput.value,
                    price: pricc.options[pricc.selectedIndex].value,
                    image: imageInput.value,
                }),
            });

            // Get the response data and display it to the user
            const responseData = await adResponse.json();
            alert(responseData);
        });

        form.appendChild(nameDiv);
        form.appendChild(subjectsDiv);
        form.appendChild(gradeDiv);
     form.appendChild(costDiv);
     form.appendChild(imageDiv);
     form.appendChild(submitButton);

     document.getElementById("ad-form-container").appendChild(form);

     // Add a submit event listener to the form
     form.addEventListener("submit", async (event) => {
         event.preventDefault(); // Prevent the default form submission behavior

         // Check if the entered username exists
         const username = nameInput.value;
         const tutorResponse = await fetch(`/tutor/${username}`);
         if (tutorResponse.status === 404) {
             alert("Username not found. Ad cannot be posted.");
             return;
         }
     });
 }

 // Add a submit event listener to the form
    const onSubmit = async (event) => {
        event.preventDefault(); // Prevent the default form submission behavior

        // Check if the entered username exists
        const username = nameInput.value;
        const tutorResponse = await fetch(`/tutor/${username}`);
        if (tutorResponse.status === 404) {
            alert("Username not found. Ad cannot be posted.");
            form.removeEventListener("submit", onSubmit); // Remove the event listener
            return;
        }

        // Send a POST request to the server to post the ad
        const adResponse = await fetch("/postad", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                subject: subjectsInput.value,
                class: gradeInput.value,
                time: nameInput.value,
                price: costInput.value,
                image: imageInput.value,
            }),
        });

        // Get the response data and display it to the user
        const responseData = await adResponse.json();
        alert(responseData);
    };

    form.addEventListener("submit", onSubmit);


    function displayReviewsPage() {
        // Add code to display reviews page here
    }
    async function displayRequestsPage() {
         document.querySelector('.deletereviews').innerHTML = "";
        document.getElementById("requests-container").innerHTML = "";
           document.getElementById("tutors-data").innerHTML = "";
        document.getElementById("announcement-data").innerHTML = "";
        document.querySelector(".search-container").style.display = "none";
        document.getElementById("ad-form-container").innerHTML = "";
        const appointmentsContainer = document.querySelector(".appointments-container");
        appointmentsContainer.innerHTML = "";

        const email = localStorage.getItem("username");
        const response = await fetch(`/apptviaemail/${email}`);
        const data = await response.json();

        if (response.status === 200) {
            const requestsContainer = document.getElementById("requests-container");
            requestsContainer.style.display = "flex";
            requestsContainer.style.flexWrap = "wrap";
            requestsContainer.style.gap = "10px";

            for (let i = 0; i < data.length; i++) {
                const requestBox = document.createElement("div");
                requestBox.style.backgroundColor = "#f5f5f5";
                requestBox.style.border = "1px solid #ddd";
                requestBox.style.padding = "10px";
                requestBox.style.borderRadius = "5px";

                const idRequest = document.createElement("p");
                idRequest.textContent= `Request ID : ${data[i]._id}`;
                const name= document.createElement("p");
                name.textContent= `Email of student : ${data[i].username}`;
                const coursesLabel = document.createElement("p");
                coursesLabel.textContent = `Courses requested: ${data[i].courses}`;
                const daysLabel = document.createElement("p");
                daysLabel.textContent = `Days per week: ${data[i].days}`;
                const hoursLabel = document.createElement("p");
                hoursLabel.textContent = `Hours per day: ${data[i].hours}`;
                const bidLabel = document.createElement("p");
                bidLabel.textContent = `Bid: ${data[i].bid}`;
             const acceptBtn = document.createElement('button');
                acceptBtn.style.width = '100px';
                acceptBtn.style.height = '50px';
                const acceptText = document.createTextNode('Accept');
                acceptBtn.appendChild(acceptText);
                 acceptBtn.onclick = async () => {
                    try {
                        const tutorEmail = localStorage.getItem("username");
                        const requestBody = {
                            requestId: data[i]._id,
                            courses: data[i].courses,
                            days: data[i].days,
                            hours: data[i].hours,
                            bid: data[i].bid,
                            studentEmail: data[i].username,
                            desc: data[i].desc,
                        };
                         const requestBody2 = {
                            requestId: data[i]._id,
                            courses: data[i].courses,
                            days: data[i].days,
                            hours: data[i].hours,
                            bid: data[i].bid,
                            studentEmail: tutorEmail,
                            desc: data[i].desc,
                        };
                        const tutorResponse = await fetch(`/confirmedappts/${tutorEmail}/ads`, {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify(requestBody),
                        });
                        const tutorData = await tutorResponse.json();
                        if (tutorResponse.status === 404) {
                            throw new Error("Tutor not found");
                        }

                        const studentResponse = await fetch(
                            `/confirmedapptsStudent/${data[i].username}/ads`,
                            {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify(requestBody2),
                            }
                        );
                        const studentData = await studentResponse.json();
                        if (studentResponse.status === 404) {
                            throw new Error("Student not found");
                        }

                        const deleteResponse = await fetch(
                            `/requestsappt/${tutorEmail}/${data[i]._id}`,
                            {
                                method: "DELETE",
                            }
                        );
                        if (deleteResponse.status === 404) {
                            throw new Error("Appointment not found");
                        }

                        // Remove request box from the UI
                        alert("Appointment approved successfully!");
                        requestsContainer.removeChild(requestBox);
                    } catch (err) {
                        console.error(err);
                        alert("Something went wrong, please try again later.");
                    }
                };
              
                /// decline function functionality
                const declineBtn = document.createElement('button');
           declineBtn.style.width = '100px';
                declineBtn.style.height = '50px';
                const declineText = document.createTextNode('Decline');
                declineBtn.onclick = function () {
                    const email = localStorage.getItem('username');
                    const id = data[i]._id;

                    fetch(`/requestsappt/${email}/${id}`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Something went wrong!');
                            }
                            return response.json();
                        })
                        .then(data => {
                            console.log(data);
                            alert("Appointment declined successfully")
                            displayRequestsPage();
                            // handle success response from backend
                        })
                        .catch(error => {
                            console.error(error);
                            // handle error response from backend
                        });
                };
                declineBtn.appendChild(declineText);
                //////////// decline function ended

                if (data[i].desc) {
                    const descLabel = document.createElement("p");
                    descLabel.textContent = `Description: ${data[i].desc}`;
                    requestBox.append(idRequest,name,coursesLabel, daysLabel, hoursLabel, bidLabel, descLabel, acceptBtn, declineBtn);
                } else {
                    requestBox.append(idRequest,name,coursesLabel, daysLabel, hoursLabel, bidLabel, acceptBtn, declineBtn);
                }
                requestsContainer.appendChild(requestBox);
            }
           
        

        } else {
            console.log("Error retrieving requests");
        }
    }

 function displayAppointmentsPage() {
     document.querySelector('.deletereviews').innerHTML = "";
        document.getElementById("tutors-data").innerHTML = "";
        document.getElementById("announcement-data").innerHTML = "";
        document.querySelector(".search-container").style.display = "none";
        document.getElementById("ad-form-container").innerHTML = "";
        const appointmentsContainer = document.querySelector(".appointments-container");
        appointmentsContainer.innerHTML = "";

        // Clear previous results from requests container
        document.getElementById("requests-container").innerHTML = "";

        const email = localStorage.getItem("username");
        if (!email) {
            console.error("Email not found in local storage");
            return;
        }

        fetch(`/returningConfirmedAppts/${email}`)
            .then(res => res.json())
            .then(data => {
                const ads = data.ads;
                const appointmentBoxes = ads.map(ad => {
                    const checkboxId = `ad-${ad._id}-checkbox`;
                    return `
                    <div class="appointment-box">
                  
                        <p>Student email: ${ad.studentEmail}</p>
                        <p>Courses: ${ad.courses}</p>
                        <p>Days: ${ad.days}</p>
                        <p>Hours: ${ad.hours}</p>
                        <p>Bid: ${ad.bid}</p>
                        <p>Description: ${ad.desc}</p>
                        <h2>Appointment confirmed</h2>
                        <input type="checkbox" id="${checkboxId}" name="${checkboxId}">
                    </div>
                `;
                });

                // Group appointments into rows with a maximum of three boxes per row
              const rows = [];
                for (let i = 0; i < appointmentBoxes.length; i += 3) {
                    const row = appointmentBoxes.slice(i, i + 3).join("");
                    rows.push(`<div class="row" style="width:100%;">${row}</div>`);
                }


                appointmentsContainer.innerHTML = rows.join("");
            })
            .catch(err => {
                console.error(err);
                alert("An error occurred while fetching appointments.");
            });
    }





    function displayResourcesPage() {
         document.querySelector('.deletereviews').innerHTML = "";
           document.getElementById("tutors-data").innerHTML = "";
        document.getElementById("announcement-data").innerHTML = "";
        document.querySelector(".search-container").style.display = "none";
        document.getElementById("ad-form-container").innerHTML = "";
        const appointmentsContainer = document.querySelector(".appointments-container");
        appointmentsContainer.innerHTML = "";
    }

    async function displayDeleteReview() {
        document.getElementById("announcement-data").innerHTML = "";
        document.querySelector('.deletereviews').innerHTML = "";
        document.querySelector('.search-container').style.display = 'none';
        document.getElementById("tutors-data").innerHTML = "";
        document.querySelector('.deletereviews').innerHTML = "";
        const appointmentsContainer = document.querySelector(".appointments-container");
        appointmentsContainer.innerHTML = '<h1 style="text-align: center;">All Reviews</h1><br>';

        const email = localStorage.getItem("username");
        if (!email) {
            console.error("Email of tutor not found in database, database error");
            return;
        }

        const reviewsResponse = await fetch(`/returnRelevantReviews/${email}`);
        const reviewsData = await reviewsResponse.json();

        const reviewsContainer = document.querySelector(".deletereviews");
        reviewsContainer.innerHTML = "";

        reviewsData.forEach((review) => {
            const reviewCard = document.createElement("div");
            reviewCard.classList.add("review-card");

            const content = document.createElement("p");
            content.innerText = review.content;
            reviewCard.appendChild(content);

            const tutorEmail = document.createElement("p");
            tutorEmail.innerText = `Tutor email: ${review.tutorEmail}`;
            reviewCard.appendChild(tutorEmail);

            const studentEmail = document.createElement("p");
            studentEmail.innerText = `Student email: ${review.studentEmail}`;
            reviewCard.appendChild(studentEmail);
            reviewsContainer.appendChild(reviewCard);
        });

        // Add styles to the reviews container
        reviewsContainer.style.display = "flex";
        reviewsContainer.style.flexWrap = "wrap";
        reviewsContainer.style.justifyContent = "center";

        // Add styles to the review cards
        const reviewCards = document.querySelectorAll(".review-card");
        reviewCards.forEach((card) => {
            card.style.width = "300px";
            card.style.height = "300px";
            card.style.backgroundColor = "#fff";
            card.style.border = "1px solid #ccc";
            card.style.borderRadius = "10px";
            card.style.boxShadow = "2px 2px 10px #ccc";
            card.style.margin = "20px";
            card.style.padding = "10px";
            card.style.display = "flex";
            card.style.flexDirection = "column";
            card.style.justifyContent = "space-between";
        });

        // Add styles to the review content
        const contents = document.querySelectorAll(".review-card p:first-child");
        contents.forEach((content) => {
            content.style.fontSize = "16px";
            content.style.fontWeight = "bold";
            content.style.marginBottom = "10px";
            content.style.overflow = "hidden";
            content.style.textOverflow = "ellipsis";
            content.style.whiteSpace = "nowrap";
        });

        // Add styles to the review emails
        const emails = document.querySelectorAll(".review-card p:not(:first-child)");
        emails.forEach((email) => {
            email.style.fontSize = "14px";
            email.style.color = "#888";
            email.style.marginTop = "10px";
        });
    }

    function displayAnnouncementsPage() {
         document.querySelector('.deletereviews').innerHTML = "";
          document.getElementById("requests-container").innerHTML = "";
           document.getElementById("tutors-data").innerHTML = "";
        document.getElementById("announcement-data").innerHTML = "";
        document.querySelector(".search-container").style.display = "none";
        document.getElementById("ad-form-container").innerHTML = "";
        const appointmentsContainer = document.querySelector(".appointments-container");
        appointmentsContainer.innerHTML = "";
        fetch("/viewann")
            .then((response) => response.json())
            .then((data) => {
                let html = `
         
            `;
                for (let i = 0; i < data.announcements.length; i++) {
                    html += `
          <div class="announcement-card">
            <h1>${data.announcements[i].content}</h1>
            <p>${data.announcements[i].createdAt}</p>
            <br>
          
          </div>`;
                }
                document.getElementById("announcement-data").innerHTML = html;
            })
            .catch((err) => {
                // Display an error message if the request fails
                console.log("failure");
            });
    }

    function displaySettingsPage() {
        window.location.href = "/settings";
    }
    // Define a global variable to store the name of the last executed function
    let lastFunctionName = 'displayHomePage';

    // Update the pushState function to store the name of the current function in the history state object
    window.history.pushState({ functionName: lastFunctionName }, page, `/${page.toLowerCase()}`);

    // Add code to the popstate event listener to execute the last executed function again
    window.addEventListener('popstate', (event) => {
        displayHomePage();
    }
    );

</script>